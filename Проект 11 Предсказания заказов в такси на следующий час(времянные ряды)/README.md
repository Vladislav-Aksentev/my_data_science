# Предсказания заказов в такси на следующий час(времянные ряды).  

Подготовка модели  для предсказания количества заказов в такси на следующий час с использованием времянных рядов.  

### Общий вывод:

Проведена предобработка данных.Данные проанализированы, построены графики для построения действий по обучению модели. Было решено добавить признаки временных сдвигов и скользящего среднего для преобразования временного ряда в более стационарный. Лучшие результаты обучненных на тренировочной выборке моделей с наиболее подходящими параметрами по GSCV:

RandomForestRegressor
РМСЕ 21.85833750027443 Самые лучшие параметры модели = {'max_depth': 10, 'n_estimators': 100}
при количестве времсенных сдвигов = 1
при скользящем среднем с окном = 8
CatBoostRegressor
РМСЕ 22.709751630147853 Самые лучшие параметры модели = {'max_depth': 10, 'n_estimators': 100}
при количестве времсенных сдвигов = 1
при скользящем среднем с окном = 8
LGBMRegressor
21.27038396093088 Самые лучшие параметры модели = {'max_depth': 10, 'n_estimators': 75}
при количестве времсенных сдвигов = 1
при скользящем среднем с окном = 8

Наилучший результат показала модель LGBMRegressor. На тестовой выборке результат ухудшился до 31.438495916484552, но всё ещё удовлетваряет, т.к. верхний порог по заданию = 48. Модель подготовлена.

Из графика сравнения прогноза и факта видно, что чаще всего прогноз ниже факта, что приведёт к убыткам. Скорее всего на рынке начал действовать фактор, которого не было при обучении модели(пример - возвращение с отпусков в августе.) Необходимы дополнительные данные и уточнения у бизнеса.  

### Статус проекта:

Проект сдан.  

### Библиотеки, используемые в проекте:

pandas  
numpy  
matplotlib.pyplot  

statsmodels.tsa.seasonal.seasonal_decompose  

sklearn.metrics.mean_squared_error  
sklearn.model_selection.train_test_split  
sklearn.ensemble.RandomForestRegressor  
sklearn.model_selection.GridSearchCV  

lightgbm.LGBMRegressor  

catboost.CatBoostRegressor
